ports:
  web:
    port: 8000
    exposedPort: 80
    protocol: TCP
    # redirectTo: #TODO:: enable this redirect after testing is complete
      # port: websecure
      # priority: 10
  websecure:
    http3:
      enabled: true
    port: 8443
    exposedPort: 443
    protocol: TCP
    tls:
      enabled: true
ingressRoute:
  dashboard:
    enabled: false
service:
  annotations:
    external-dns.alpha.kubernetes.io/hostname: traefik.stilo.ca, game-2048.stilo.ca #add multiple separated with commas: rabbitmq.stilo.ca, postgres.stilo.ca
    service.beta.kubernetes.io/aws-load-balancer-type: external #TODO:: or nlb? seems external is setting nlb...
    service.beta.kubernetes.io/aws-load-balancer-ssl-ports: "443"
    service.beta.kubernetes.io/aws-load-balancer-nlb-target-type: ip
    service.beta.kubernetes.io/aws-load-balancer-scheme: internet-facing
    service.beta.kubernetes.io/aws-load-balancer-ssl-cert: arn:aws:acm:us-east-1:529088285154:certificate/d30c4b6b-c8f9-4664-9c7f-7a8fff8f657f # TODO:: pull dynamically or from secrets
    service.beta.kubernetes.io/load-balancer-source-ranges: 0.0.0.0/0
globalArguments:
  - "--api.dashboard=true" # enable for insecure dashboard - required for port forwarding to work
  - "--api.insecure=true" # enable for insecure dashboard - required for port forwarding to work
  - "--global.sendanonymoususage=false"
  - "--global.checknewversion=false"
additionalArguments:
  - "--serversTransport.insecureSkipVerify=true"
  - "--log.level=DEBUG"
logs:
  general:
    level: DEBUG
  access:
    enabled: false

rbac:
  enabled: true


deployment:
  enabled: true
  replicas: 1 # TODO:: bump up to 3
  annotations: {}
  podAnnotations: {}
  additionalContainers: []
  initContainers: []

providers:
  kubernetesCRD:
    enabled: true
    ingressClass: traefik-external
    allowExternalNameServices: true
  kubernetesIngress:
    enabled: true
    allowExternalNameServices: true
    publishedService:
      enabled: false


# TESTING
# ---
# ingressClass:
#   enabled: true
#   isDefaultClass: true
#   fallbackApiVersion: v1
# ingressRoute:
#   dashboard:
#     enabled: false
# service:
#   annotations:
#     service.beta.kubernetes.io/aws-load-balancer-type: nlb
# globalArguments:
# - "--api.insecure=true"